<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ResumeCraft</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <style>
    :root {
      --primary: #009dff;
      --transition: 0.3s;
      --bg: #1a1a1a;
      --highlight: #864cf9;
    }

    body {
      margin: 0;
      padding: 100px 20px;
      background: #020507;
      font-family: cursive;
      color: white;
      overflow-y: scroll;
      -ms-overflow-style: none;
      scrollbar-width: none;
    }

    body::-webkit-scrollbar {
      display: none;
    }

    header {
      position: fixed; top:0; width:100%; background:black;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2); padding:15px; z-index: 1000;
    }

    .controls {
      text-align:center; margin: 10px 0; z-index: 999;
    }

    button, input[type=file], input[type=range] {
      margin: 0 5px; padding:8px 12px; background:var(--primary);
      border:none; border-radius:20px; cursor:pointer; transition:var(--transition);
    }

    button:hover { background:black; color:var(--primary); }

    .resume-template {
      position:relative;
      width:794px; height:1123px;
      margin:auto; padding:30px; background:var(--bg);
      border: 2px solid var(--highlight); overflow:hidden;
    }

    .draggable {
      position:absolute; cursor:grab;
    }

    [contenteditable="true"] {
      border:2px dashed var(--highlight); padding:5px; outline:none;
      color: aqua;
    }

    .section-title {
      background: var(--highlight); color: black;
      padding: 5px; font-weight: bold;
    }

    #profileWrapper {
      width: 160px; height: 160px;
      position: absolute;
      top: 20px; left: 20px;
    }

    #profilePic {
      width:120px; height:120px;
      object-fit:cover;
      border:3px solid var(--highlight);
      border-radius:50%;
      position:absolute;
      top:20px; left:20px;
      z-index: 2;
    }

    #profilePic2 {
      width: 160px; height: 160px;
      position: absolute;
      top: 0; left: 0;
      pointer-events: none;
      z-index: 1;
    }

    #profilePic2::before,
    #profilePic2::after {
      content: "";
      position: absolute;
      border-radius: 50%;
      border: 3px dotted var(--highlight);
      animation: pulse 3s infinite ease-in-out;
    }

    #profilePic2::before {
      width: 140px;
      height: 140px;
      top: 10px;
      left: 10px;
      border-color: var(--highlight);
    }

    #profilePic2::after {
      width: 160px;
      height: 160px;
      top: 0;
      left: 0;
      border-color: var(--primary);
      animation-delay: 1.5s;
    }

    @keyframes pulse {
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.1); opacity: 0.6; }
      100% { transform: scale(1); opacity: 1; }
    }

  </style>
</head>
<body>

<header><h1>ResumeCraft</h1></header>
<div class="controls">
  <input type="file" id="imageUpload" accept="image/*" />
  <input id="resizeSlider" type="range" min="60" max="200" value="120" title="Resize" />
  <button onclick="resetProfilePicture()">Reset Picture</button>
  <button onclick="resetAll()">Reset All</button>
  <button id="editBtn" onclick="toggleEditMode()">Edit Mode</button>
  <button onclick="downloadResume()">Download PDF</button>
</div>

<div id="resume" class="resume-template">
  <div id="profileWrapper" class="draggable">
    <img id="profilePic" draggable="false" />
    <div id="profilePic2"></div>
  </div>

  <div id="nameBox" class="draggable" contenteditable="true" style="top:20px;left:200px; font-size:2em;font-weight:bold;">Your Name</div>
  <div id="titleBox" class="draggable" contenteditable="true" style="top:100px;left:200px; font-size:1.2em;color:#ccc;">Your Job Title</div>

  <div id="sumTitle" class="draggable section-title" style="top:140px;left:600px;">★ Summary</div>
  <div id="sumBox" class="draggable" contenteditable="true" style="top:190px;left:30px;">A brief summary...</div>

  <div id="eduTitle" class="draggable section-title" style="top:240px;left:30px;">★ Education</div>
  <div id="eduBox" class="draggable" contenteditable="true" style="top:280px;left:30px;">Education details...</div>

  <div id="skillsTitle" class="draggable section-title" style="top:340px;left:600px;">★ Skills</div>
  <ul id="skillsBox" class="draggable" contenteditable="true" style="top:380px;left:30px;">
    <li>Skill 1</li>
    <li>Skill 2</li>
  </ul>

  <div id="expTitle" class="draggable section-title" style="top:460px;left:30px;">★ Experience</div>
  <ul id="expBox" class="draggable" contenteditable="true" style="top:500px;left:30px;">
    <li>Experience 1</li>
    <li>Experience 2</li>
  </ul>

  <div id="contactTitle" class="draggable section-title" style="top:580px;left:30px;">★ Contact</div>
  <div id="contactBox" class="draggable" contenteditable="true" style="top:620px;left:30px;">Email & Phone...</div>
</div>

<script>
let dragged = null, dx=0, dy=0;
const resume = document.getElementById('resume');
const editBtn = document.getElementById('editBtn');

// Drag
resume.addEventListener('mousedown', e => {
  if (!resume.classList.contains('edit')) return;
  if (!e.target.closest('.draggable')) return;
  dragged = e.target.closest('.draggable');
  const rect = dragged.getBoundingClientRect();
  dx = e.clientX - rect.left;
  dy = e.clientY - rect.top;
  dragged.style.cursor = 'grabbing';
});

document.addEventListener('mousemove', e => {
  if (!dragged) return;
  const rect = resume.getBoundingClientRect();
  let x = e.clientX - rect.left - dx;
  let y = e.clientY - rect.top - dy;
  x = Math.max(0, Math.min(x, rect.width - dragged.offsetWidth));
  y = Math.max(0, Math.min(y, rect.height - dragged.offsetHeight));
  dragged.style.left = x + 'px';
  dragged.style.top = y + 'px';
});

document.addEventListener('mouseup', () => {
  if (dragged) dragged.style.cursor = 'grab';
  dragged = null;
});

// Resize profile pic
document.getElementById('resizeSlider').oninput = e => {
  const s = e.target.value + 'px';
  const pic = document.getElementById('profilePic');
  pic.style.width = s;
  pic.style.height = s;
};

// Upload image
document.getElementById('imageUpload').onchange = e => {
  const file = e.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = evt => {
    document.getElementById('profilePic').src = evt.target.result;
    document.getElementById('profilePic').style.display = 'block';
  };
  reader.readAsDataURL(file);
};

// Reset profile pic
function resetProfilePicture() {
  document.getElementById('profilePic').src = '';
}

// Edit mode
function toggleEditMode() {
  const on = resume.classList.toggle('edit');
  document.querySelectorAll('[contenteditable]').forEach(el => el.contentEditable = on);
  editBtn.textContent = on ? 'Save Changes' : 'Edit Mode';
  if (!on) localStorage.saved = resume.innerHTML;
}

// Reset all
function resetAll() {
  if (confirm("Reset all fields and image?")) {
    localStorage.removeItem('saved');
    location.reload();
  }
}

// Download as PDF
function downloadResume() {
  if (resume.classList.contains('edit')) toggleEditMode();
  html2pdf().set({
    margin: 0,
    filename: 'resume.pdf',
    image: { type: 'jpeg', quality: 1 },
    html2canvas: { scale: 2, useCORS: true },
    jsPDF: { unit: 'px', format: [794, 1123], orientation: 'portrait' }
  }).from(resume).save();
}

// Load saved version
window.onload = () => {
  if (localStorage.saved && confirm('Load saved resume?')) resume.innerHTML = localStorage.saved;
};
</script>

</body>
</html>
